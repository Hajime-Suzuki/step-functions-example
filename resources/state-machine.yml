name: bank-account-change-state

tracingConfig:
  enabled: true

events:
  - http:
      path: /
      method: POST

definition:
  Comment: workflows for changing bank account
  StartAt: CreateRequest
  States:
    CreateRequest:
      Type: Task
      Comment: 'create a request for changing bank account'
      Resource: !GetAtt CreateRequest.Arn
      Next: ValidateBankAccount

    ValidateBankAccount:
      Type: Task
      Comment: 'validate bank account'
      Resource: !GetAtt ValidateBankAccount.Arn
      Catch:
        - ErrorEquals: ['InvalidBankAccountError']
          Next: NotifyInvalidBankAccount
      Next: ApproveRequest

    NotifyInvalidBankAccount:
      Type: Pass
      Comment: 'notify user if bank account info is invalid'
      End: true

    ApproveRequest:
      Type: Pass
      Comment: 'manually approve the bank account changes'
      End: true
